function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,i){return t&&_defineProperties(e.prototype,t),i&&_defineProperties(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{Oytz:function(e,t,i){"use strict";i.r(t),i.d(t,"ProfesseurModule",(function(){return x}));var n=i("ofXK"),s=i("3Pt+"),r=i("tyNb"),o=i("PSD3"),a=i.n(o),c=i("fXoL"),u=i("kESC"),d=i("zuHl"),l=i("oLy0"),b=i.n(l),h=["EmpNameInput"];function p(e,t){if(1&e&&(c.Mb(0,"div",12),c.Mb(1,"label",13),c.jc(2,"Username"),c.Lb(),c.Kb(3,"input",14,15),c.Lb()),2&e){var i=t.$implicit;c.zb(3),c.ac("value",i)}}function m(e,t){if(1&e&&(c.Mb(0,"div",12),c.Mb(1,"label",16),c.jc(2,"Room"),c.Lb(),c.Kb(3,"input",17),c.Lb()),2&e){var i=t.$implicit;c.zb(3),c.ac("value",i)}}var f,g=((f=function(){function e(t,i){var n=this;_classCallCheck(this,e),this.instantChatservice=t,this.sharedService=i,this.peerList=[],this.messageArray=[],this.EmployeNameList=[],this.ReunionNameList=[],this.d=new Date,this.hours=this.d.getHours(),this.minute=this.d.getMinutes(),this.second=this.d.getSeconds(),this.jour=this.d.getDate(),this.mois=this.d.getMonth()+1,this.ans=this.d.getFullYear(),this.getPeerId=function(){n.peer.on("open",(function(e){n.peerId=e})),n.peer.on("call",(function(e){navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(t){n.lazyStream=t,e.answer(t),e.on("stream",(function(t){n.peerList.includes(e.peer)||(n.streamRemoteVideo(t),n.currentPeer=e.peerConnection,n.peerList.push(e.peer))}))})).catch((function(e){console.log(e+"Unable to get media")}))}))},this.peer=new b.a,this.instantChatservice.newUserJoined().subscribe((function(e){return n.messageArray.push(e)})),this.instantChatservice.userLeftRoom().subscribe((function(e){return n.messageArray.push(e)}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.getPeerId(),this.sharedService.GetEmpName(this.sharedService.IdentifEmp).subscribe((function(t){e.EmployeNameList=t})),console.log(this.EmployeNameList),this.sharedService.GetRunName(this.sharedService.IdentfRun).subscribe((function(t){e.ReunionNameList=t}))}},{key:"join",value:function(){this.instantChatservice.joinRoom({user:this.EmpNameInput.nativeElement.value,room:this.room});var e={REUNION:this.sharedService.IdentfRun,LOCUTEUR_ENSEIGANT:this.sharedService.IdentifEmp,DATE_CREATION:String(this.jour)+"-"+String(this.mois)+"-"+String(this.ans)+" "+String(this.hours)+":"+String(this.minute)+":"+String(this.second),DATE_FIN:String(this.jour)+"-"+String(this.mois)+"-"+String(this.ans)+" "+String(this.hours)+":"+String(this.minute)+":"+String(this.second),TOKEN_ENSEIGANT:this.peerId};console.log(e),this.sharedService.addDiscussionVideo(e).subscribe((function(e){a.a.fire({position:"bottom-start",title:'<div style="font-family: segoe;font-size: 20px;color:#000000; font-weight: bold;">'+e.toString()+"</div>",showConfirmButton:!1,background:"#ffffff00",backdrop:"rgb(0 0 0 / 0%)",timer:1500,hideClass:{popup:"animate__animated animate__bounceOutLeft"}})}))}},{key:"leave",value:function(){this.instantChatservice.leaveRoom({user:this.EmpNameInput.nativeElement.value,room:this.room})}},{key:"connectWithPeer",value:function(){this.callPeer(this.peerIdShare)}},{key:"callPeer",value:function(e){var t=this;navigator.mediaDevices.getUserMedia({video:!0,audio:!0}).then((function(i){t.lazyStream=i;var n=t.peer.call(e,i);n.on("stream",(function(e){t.peerList.includes(n.peer)||(t.streamRemoteVideo(e),t.currentPeer=n.peerConnection,t.peerList.push(n.peer))}))})).catch((function(e){console.log(e+"Unable to connect")}))}},{key:"streamRemoteVideo",value:function(e){var t=document.createElement("video");t.classList.add("video"),t.srcObject=e,t.play(),document.getElementById("remote-video").style.backgroundColor="#1b1a1ad6",document.getElementById("remote-video").append(t)}},{key:"screenShare",value:function(){this.shareScreen()}},{key:"shareScreen",value:function(){var e=this;navigator.mediaDevices.getDisplayMedia({video:{cursor:"always"},audio:{echoCancellation:!0,noiseSuppression:!0}}).then((function(t){var i=t.getVideoTracks()[0];i.onended=function(){e.stopScreenShare()},e.currentPeer.getSenders().find((function(e){return e.track.kind===i.kind})).replaceTrack(i)})).catch((function(e){console.log("Unable to get display media "+e)}))}},{key:"stopScreenShare",value:function(){var e=this.lazyStream.getVideoTracks()[0];this.currentPeer.getSenders().find((function(t){return t.track.kind===e.kind})).replaceTrack(e)}}]),e}()).\u0275fac=function(e){return new(e||f)(c.Jb(u.a),c.Jb(d.a))},f.\u0275cmp=c.Db({type:f,selectors:[["app-screen-share"]],viewQuery:function(e,t){var i;1&e&&c.mc(h,!0),2&e&&c.dc(i=c.Vb())&&(t.EmpNameInput=i.first)},decls:22,vars:2,consts:[[2,"display","flex","flex-wrap","wrap","margin-right","-15px","margin-left","0px"],[2,"margin-right","-15px"],[1,"col-sm-2"],["class","form-group",4,"ngFor","ngForOf"],[1,"row"],[1,"col","sm-2"],[2,"margin-top","19px"],[1,"btn","btn-primary",2,"background-color","#6264a7","border-color","#6264a7",3,"mousedown","mouseup"],[1,"btn","btn-primary",2,"background-color","#6264a7","border-color","#6264a7",3,"click"],["type","button",1,"btn","btn-default",3,"click"],["id","remote-video",2,"width","643px","height","483px","border","2px solid","margin-left","15px"],[2,"margin-top","0px"],[1,"form-group"],["for","username"],["type","text","id","username","name","username","disabled","",3,"value"],["EmpNameInput",""],["for","room"],["type","text","id","room","name","room","disabled","",3,"value"]],template:function(e,t){1&e&&(c.Mb(0,"div"),c.Mb(1,"div",0),c.Mb(2,"div",1),c.Mb(3,"div",2),c.ic(4,p,5,1,"div",3),c.Lb(),c.Lb(),c.Mb(5,"div",4),c.Mb(6,"div",2),c.ic(7,m,4,1,"div",3),c.Lb(),c.Lb(),c.Mb(8,"div",4),c.Kb(9,"div",2),c.Lb(),c.Mb(10,"div",5),c.Mb(11,"div",6),c.Mb(12,"button",7),c.Ub("mousedown",(function(){return t.connectWithPeer()}))("mouseup",(function(){return t.join()})),c.jc(13,"D\xe9marer "),c.Lb(),c.jc(14," \xa0\xa0 "),c.Mb(15,"button",8),c.Ub("click",(function(){return t.screenShare()})),c.jc(16,"Screen share"),c.Lb(),c.Mb(17,"button",9),c.Ub("click",(function(){return t.leave()})),c.jc(18,"Leave"),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Kb(19,"div",10),c.Kb(20,"br"),c.Kb(21,"div",11),c.Lb()),2&e&&(c.zb(4),c.Zb("ngForOf",t.EmployeNameList),c.zb(3),c.Zb("ngForOf",t.ReunionNameList))},directives:[n.h],styles:["video[_ngcontent-%COMP%]{width:639px;height:483px}"]}),f),v=["EmpNameInput"];function y(e,t){if(1&e&&(c.Mb(0,"tr"),c.Mb(1,"td"),c.jc(2),c.Lb(),c.Lb()),2&e){var i=t.$implicit;c.zb(2),c.kc(i)}}function L(e,t){if(1&e&&(c.Mb(0,"div"),c.Mb(1,"div",15),c.Mb(2,"p",16),c.jc(3),c.Lb(),c.Mb(4,"div",17),c.jc(5),c.Lb(),c.Lb(),c.Lb()),2&e){var i=t.$implicit;c.zb(3),c.kc(i.message),c.zb(2),c.kc(i.user)}}var M,S,E,C=[{path:"",loadChildren:function(){return i.e(10).then(i.bind(null,"5yvZ")).then((function(e){return e.GererReunionModule}))}},{path:"Chat",component:(M=function(){function e(t,i){var n=this;_classCallCheck(this,e),this.instantChatservice=t,this.sharedService=i,this.title="instant-chatting",this.messageArray=[],this.ProfesseurList=[],this.EmployeMsgList=[],this.EmployeNameList=[],this.ReunionNameList=[],this.ReunionList=[],this.d=new Date,this.hours=this.d.getHours(),this.minute=this.d.getMinutes(),this.second=this.d.getSeconds(),this.jour=this.d.getDate(),this.mois=this.d.getMonth()+1,this.ans=this.d.getFullYear(),this.instantChatservice.newUserJoined().subscribe((function(e){return n.messageArray.push(e)})),this.instantChatservice.userLeftRoom().subscribe((function(e){return n.messageArray.push(e)})),this.instantChatservice.newMessageReceived().subscribe((function(e){return n.messageArray.push(e)}))}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.sharedService.GetEmpMsg(this.sharedService.IdentfRun).subscribe((function(t){e.EmployeMsgList=t})),console.log(this.EmployeMsgList),this.sharedService.GetEmpName(this.sharedService.IdentifEmp).subscribe((function(t){e.EmployeNameList=t})),console.log(this.EmployeNameList),this.sharedService.GetRunName(this.sharedService.IdentfRun).subscribe((function(t){e.ReunionNameList=t})),console.log(this.ReunionNameList)}},{key:"sendMessage",value:function(){this.instantChatservice.sendMessage({user:this.EmployeNameList,room:this.room,message:this.messageText});var e={REUNION:this.sharedService.IdentfRun,LOCUTEUR_ENSEIGANT:this.sharedService.IdentifEmp,TEXT:this.messageText,DATE_CREATION:String(this.jour)+"-"+String(this.mois)+"-"+String(this.ans)+" "+String(this.hours)+":"+String(this.minute)+":"+String(this.second)};console.log(e),this.sharedService.addDiscussionText(e).subscribe((function(e){a.a.fire({position:"bottom-start",title:'<div style="font-family: segoe;font-size: 20px;color:#000000; font-weight: bold;">'+e.toString()+"</div>",showConfirmButton:!1,background:"#ffffff00",backdrop:"rgb(0 0 0 / 0%)",timer:1500,hideClass:{popup:"animate__animated animate__bounceOutLeft"}})}))}},{key:"addDiscussFile",value:function(){var e={REUNION:this.sharedService.IdentfRun,LOCUTEUR_ENSEIGANT:this.sharedService.IdentifEmp,NOM_FICHIER:this.NOM_FICHIER,DATE_CREATION:String(this.jour)+"-"+String(this.mois)+"-"+String(this.ans)+" "+String(this.hours)+":"+String(this.minute)+":"+String(this.second)};this.sharedService.addDiscussFile(e).subscribe((function(e){a.a.fire({position:"bottom-start",title:'<div style="font-family: segoe;font-size: 20px;color:#000000; font-weight: bold;">'+e.toString()+"</div>",showConfirmButton:!1,background:"#ffffff00",backdrop:"rgb(0 0 0 / 0%)",timer:1500,hideClass:{popup:"animate__animated animate__bounceOutLeft"}})}))}},{key:"uploadFile",value:function(e){var t=this,i=e.target.files[0],n=new FormData;n.append("uploadedFile",i,i.name),this.sharedService.UploadFile(n).subscribe((function(e){t.NOM_FICHIER=e.toString()}))}}]),e}(),M.\u0275fac=function(e){return new(e||M)(c.Jb(u.a),c.Jb(d.a))},M.\u0275cmp=c.Db({type:M,selectors:[["app-chat-app"]],viewQuery:function(e,t){var i;1&e&&c.mc(v,!0),2&e&&c.dc(i=c.Vb())&&(t.EmpNameInput=i.first)},inputs:{prf:"prf",run:"run"},decls:30,vars:4,consts:[[2,"position","absolute","top","70px","padding-left","752px"],[1,"row"],[2,"padding-left","485px","font-family","segoe"],[4,"ngFor","ngForOf"],[1,"well",2,"height","200px","padding","15px","padding-left","500px","font-family","segoe"],[2,"display","block","-ms-flex-wrap","wrap","flex-wrap","wrap","margin-right","-15px","margin-left","-290px","margin-top","183px"],[1,"input-group","mb-3",2,"width","800px"],[1,"col-sm-2"],[2,"padding",".375rem .75rem","color","#464775","background-color","#bbbcdd"],[1,"large","material-icons"],["type","file","hidden","",3,"change"],[1,"input-group-prepend"],["type","button",2,"padding",".375rem .75rem","box-shadow","0 0.2rem 0.4rem -0.075rem rgb(0 0 0 / 25%)","background","#6264a7","border","0","color","#fff",3,"click"],[1,"medium","material-icons"],["type","text",1,"col-sm-3",3,"ngModel","ngModelChange"],[1,"message-blue"],[1,"message-content"],[1,"message-timestamp-left"]],template:function(e,t){1&e&&(c.Mb(0,"div"),c.Kb(1,"app-screen-share"),c.Lb(),c.Mb(2,"div",0),c.Mb(3,"div",1),c.Kb(4,"hr"),c.Lb(),c.Mb(5,"div",2),c.Mb(6,"table"),c.ic(7,y,3,1,"tr",3),c.Lb(),c.Lb(),c.Mb(8,"div",1),c.Mb(9,"div",4),c.jc(10),c.ic(11,L,6,2,"div",3),c.Mb(12,"div",5),c.Mb(13,"div",6),c.Mb(14,"div",7),c.Mb(15,"label",8),c.Mb(16,"i",9),c.jc(17,"note_add"),c.Lb(),c.jc(18,"Upload"),c.Mb(19,"input",10),c.Ub("change",(function(e){return t.uploadFile(e)})),c.Lb(),c.Lb(),c.Lb(),c.Mb(20,"div",11),c.Mb(21,"button",12),c.Ub("click",(function(){return t.sendMessage()})),c.Mb(22,"i",13),c.jc(23,"send"),c.Lb(),c.jc(24,"Message"),c.Lb(),c.Mb(25,"button",12),c.Ub("click",(function(){return t.addDiscussFile()})),c.Mb(26,"i",13),c.jc(27,"send"),c.Lb(),c.jc(28,"File"),c.Lb(),c.Lb(),c.Mb(29,"input",14),c.Ub("ngModelChange",(function(e){return t.messageText=e})),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Lb(),c.Lb()),2&e&&(c.zb(7),c.Zb("ngForOf",t.EmployeMsgList),c.zb(3),c.lc("",t.messageArray," "),c.zb(1),c.Zb("ngForOf",t.messageArray),c.zb(18),c.Zb("ngModel",t.messageText))},directives:[g,n.h,s.a,s.c,s.d],styles:['.message-blue[_ngcontent-%COMP%]{position:relative;margin-left:20px;margin-bottom:10px;padding:10px;background-color:#bbbcdd;width:200px;height:50px;text-align:left;font:400 .9em Open Sans,sans-serif;border:1px solid #464775;border-radius:10px}.message-content[_ngcontent-%COMP%]{padding:0;margin:0}.message-timestamp-left[_ngcontent-%COMP%]{position:absolute;font-size:.85em;font-weight:300;bottom:5px;left:5px}.message-blue[_ngcontent-%COMP%]:after{border-top:15px solid #bbbcdd;border-left:15px solid transparent;border-right:15px solid transparent;top:0;left:-15px;display:block}.message-blue[_ngcontent-%COMP%]:after, .message-blue[_ngcontent-%COMP%]:before{content:"";position:absolute;width:0;height:0}.message-blue[_ngcontent-%COMP%]:before{border-top:17px solid #464775;border-left:16px solid transparent;border-right:16px solid transparent;top:-1px;left:-17px}']}),M)}],k=((E=function e(){_classCallCheck(this,e)}).\u0275mod=c.Hb({type:E}),E.\u0275inj=c.Gb({factory:function(e){return new(e||E)},imports:[[r.c.forChild(C)],r.c]}),E),x=((S=function e(){_classCallCheck(this,e)}).\u0275mod=c.Hb({type:S}),S.\u0275inj=c.Gb({factory:function(e){return new(e||S)},imports:[[n.b,k,s.b]]}),S)}}]);